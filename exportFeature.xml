<?xml version="1.0" encoding="UTF-8"?>
<project name="org.eclipse.safari.runtime.feature" default="build.feature.jar" basedir=".">
	<import file="../org.eclipse.safari.runtime.feature/buildCommon.xml"/>
	<import file="../org.eclipse.safari.update/buildFeatureCommon.xml"/>

	<target name="init">
		<property name="feature.name"        value="org.eclipse.safari.runtime"/>
		<property name="feature.version"     value="${runtime.version}"/>
		<property name="feature.temp.folder" value="${basedir}/feature.temp.folder"/>
		<property name="feature.destination" value="${basedir}"/>
	</target>

	<target name="all.plugins"
		depends="build.shrike,build.smapi,build.smapifier,build.jikespg,build.polyglot2,build.uide.runtime,build.safari.xform,build.safari.runtime">
	</target>

	<!-- RMF Copy the plugin jars to the 'plugins' folder so that exportUpdate script can see it -->
	<target name="gather.plugin.jars" depends="all.plugins">
		<delete failonerror="false">
			<fileset dir="plugins" includes="*.jar"/>
		</delete>
		<mkdir dir="plugins"/>
		<copy todir="plugins" file="../com.ibm.shrike/com.ibm.shrike_${feature.version}.jar"/>
		<copy todir="plugins" file="../org.eclipse.uide.runtime/org.eclipse.uide.runtime_${feature.version}.jar"/>
		<copy todir="plugins" file="../lpg/lpg_${feature.version}.jar"/>
		<copy todir="plugins" file="../polyglot2/polyglot2_${feature.version}.jar"/>
		<copy todir="plugins" file="../com.ibm.watson.smapi/com.ibm.watson.smapi_${feature.version}.jar"/>
		<copy todir="plugins" file="../com.ibm.watson.smapifier/com.ibm.watson.smapifier_${feature.version}.jar"/>
		<copy todir="plugins" file="../com.ibm.watson.safari.xform/com.ibm.watson.safari.xform_${feature.version}.jar"/>
		<copy todir="plugins" file="../org.eclipse.safari.runtime/org.eclipse.safari.runtime_${feature.version}.jar"/>
	</target>

	<!-- ========================================================================================= -->

	<target name="build.shrike">
		<antcall target="build.child">
			<param name="plugin.id" value="com.ibm.shrike"/>
		</antcall>
	</target>

	<target name="build.smapi" depends="build.shrike">
		<antcall target="build.child">
			<param name="plugin.id" value="com.ibm.watson.smapi"/>
		</antcall>
	</target>

	<target name="build.smapifier" depends="build.smapi,build.uide.runtime">
		<antcall target="build.child">
			<param name="plugin.id" value="com.ibm.watson.smapifier"/>
		</antcall>
	</target>

	<target name="build.uide.runtime" depends="build.smapi,build.jikespg">
		<antcall target="build.child">
			<param name="plugin.id" value="org.eclipse.uide.runtime"/>
		</antcall>
	</target>

	<target name="build.jikespg">
		<antcall target="build.child">
			<param name="plugin.id" value="lpg"/>
		</antcall>
	</target>

	<target name="build.polyglot2">
		<antcall target="build.child">
			<param name="plugin.id" value="polyglot2"/>
		</antcall>
	</target>

	<target name="build.safari.xform" depends="build.jikespg,build.uide.runtime">
		<antcall target="build.child">
			<param name="plugin.id" value="com.ibm.watson.safari.xform"/>
		</antcall>
	</target>

	<target name="build.safari.runtime" depends="build.polyglot2,build.safari.xform,build.smapifier">
		<antcall target="build.child">
			<param name="plugin.id" value="org.eclipse.safari.runtime"/>
		</antcall>
	</target>
</project>
